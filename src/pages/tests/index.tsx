import axios from "axios";
import { FC } from "react";
import { LoaderFunction, LoaderFunctionArgs, useLoaderData, useNavigate } from "react-router-dom";
import TestCard from "../../components/TestCard";

interface TestsProps {}

const Tests: FC<TestsProps> = ({}) => {
  const tests = useLoaderData() as { name: string; hexId: string }[];
  console.log(tests);
  return (
    <div className="mt-5 w-[45rem] mx-auto">
      <div className="bg-[#282828] px-8 pt-8 pb-6 rounded-md border-[#383838] hover:border-[#484848] border-t-[1px] border-b-[1px] border-l-[1px] border-r-[1px]">
        <header className="text-2xl font-bold">Jee-Main Tests</header>
        <div>
          {tests.map(({ name, hexId }, index) => {
            return (
                <TestCard
                  testButtonLink={`${hexId}/info`}
                  testInfo="Attempted. Click to view analysis"
                  testName={name}
                />
            );
          })}
        </div>
        <div className="mt-1 flex justify-between items-center pt-4">
          <button className="bg-[#c75c54] hover:bg-[#de4c4a] px-4 py-2 rounded-md cursor-pointer">
            Previous
          </button>
          <button className="bg-[#c75c54] hover:bg-[#de4c4a] px-4 py-2 rounded-md cursor-pointer">
            Next
          </button>
        </div>
      </div>
    </div>
  );
};

export default Tests;

export const TestsLoader: LoaderFunction = async (args: LoaderFunctionArgs) => {
  console.log("inside Tests.tsx loader");
  const response = await axios.get("http://localhost:8080/api/tests", { withCredentials: true });
  console.log(response.data);
  return response.data;
  /**
   * response.data: {name: string, id: string, ninetyNinePercentileMarks: number, durationInMinutes: number}
   */
};
